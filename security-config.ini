# Security Configuration for Universal Backup System
# This file contains security rules and patterns for the backup system

# ===========================================
# DANGEROUS POWERSHELL COMMANDS
# ===========================================
dangerous_commands = [
    # System-level operations
    "Remove-Computer",
    "Restart-Computer", 
    "Stop-Computer",
    "Clear-Host",
    "Format-Volume",
    "Remove-WindowsFeature",
    
    # Registry operations
    "Remove-ItemProperty",
    "Set-ItemProperty",
    "New-ItemProperty",
    
    # Service operations
    "Stop-Service",
    "Remove-Service",
    "Set-Service",
    
    # Process operations
    "Stop-Process",
    "Start-Process",
    
    # Network operations
    "Invoke-WebRequest",
    "Invoke-RestMethod",
    "New-NetFirewallRule",
    "Remove-NetFirewallRule",
    
    # File system operations outside project
    "Remove-Item.*C:\\\\",
    "Remove-Item.*D:\\\\",
    "Remove-Item.*/",
    "Set-Location.*C:\\\\",
    "Set-Location.*/",
    
    # User/security operations
    "New-LocalUser",
    "Remove-LocalUser",
    "Set-ExecutionPolicy",
    "Enable-PSRemoting",
    "Disable-PSRemoting"
]

# ===========================================
# ALLOWED SAFE COMMANDS
# ===========================================
safe_commands = [
    # Git operations
    "git add",
    "git commit",
    "git push",
    "git pull",
    "git status",
    "git log",
    "git tag",
    "git stash",
    "git checkout",
    "git branch",
    
    # File operations within project
    "Get-ChildItem",
    "Get-Content",
    "Set-Content",
    "Test-Path",
    "Copy-Item",
    "New-Item",
    
    # NPM/Package operations
    "npm install",
    "npm run",
    "npm test",
    "npm audit",
    "yarn install",
    "pnpm install",
    
    # Build operations
    "tsc",
    "webpack",
    "vite",
    "rollup"
]

# ===========================================
# SENSITIVE FILE PATTERNS
# ===========================================
sensitive_files = [
    "*.key",
    "*.pem",
    "*.p12", 
    "*.pfx",
    ".env*",
    "secrets.*",
    "config/database.yml",
    "config/secrets.yml",
    "*.credentials",
    "id_rsa*",
    "*.crt",
    "*.cer"
]

# ===========================================
# SAFE DIRECTORIES FOR OPERATIONS
# ===========================================
safe_directories = [
    "./",
    "./src/",
    "./scripts/",
    "./docs/", 
    "./tests/",
    "./examples/",
    "./.github/",
    "./node_modules/",
    "./dist/",
    "./build/"
]

# ===========================================
# REQUIRED VALIDATIONS
# ===========================================
required_validations = [
    "git_repository_check",
    "working_directory_validation", 
    "backup_integrity_check",
    "dependency_security_scan",
    "file_permission_check"
]

# ===========================================
# ESCALATION THRESHOLDS
# ===========================================
[escalation]
max_file_changes = 100
max_directory_depth = 5
critical_file_threshold = 10
security_scan_timeout = 300  # seconds
max_backup_size_mb = 500

# ===========================================
# NOTIFICATION SETTINGS
# ===========================================
[notifications]
slack_webhook_enabled = false
email_notifications_enabled = false
log_security_events = true
alert_on_dangerous_commands = true
require_confirmation_for_destructive = true